---
import Layout from "../../layouts/Layout.astro";
import PageHero from "../../components/hero/PageHero.astro";
import { getProductItems } from "../../utils/data";
import PortfolioFilter from "@/components/PortfolioFilter";
import { ProjectCard } from "@/components/portfolio/ProjectCard";

const productItems = await getProductItems();
const parseDateValue = (dateStr: string) => {
	const normalized = /^\d{4}-\d{2}$/.test(dateStr) ? `${dateStr}-01` : dateStr;
	return new Date(normalized).getTime();
};
const sortedItems = productItems.sort((a, b) => {
	return parseDateValue(b.date) - parseDateValue(a.date);
});

const allCategories = [...new Set(productItems.flatMap((entry) => entry.category))];
---

<Layout
	title="Products - Work"
	description="A showcase of my products and digital creations"
	image="/img/og-default.jpg"
	imageAlt="Ehsan's Products - Digital Creations and Tools"
>
	<PageHero title="Products" subtitle="A showcase of my products and digital creations" />
	<div class="py-20">
		<div class="container mx-auto px-4">
			<PortfolioFilter categories={allCategories} category="all" client:load />
			<div class="grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3">
				{
					sortedItems.map((item) => (
						<ProjectCard item={item} client:load className="portfolio-card" />
					))
				}
			</div>
		</div>
	</div>
</Layout>
