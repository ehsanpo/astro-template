---
import 'photoswipe/style.css';

interface Props {
  images: string[];
  alt: string;
}

const { images, alt } = Astro.props;
---

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
  {images.map((image, index) => (
    <a
      href={image}
      data-pswp-width="1600"
      data-pswp-height="900"
      class="gallery-item cursor-pointer"
    >
      <img
        src={image}
        alt={`${alt} - Image ${index + 1}`}
        class="w-full h-64 object-cover rounded-lg transition-transform hover:scale-105"
        loading="lazy"
      />
    </a>
  ))}
</div>

<script>
  import PhotoSwipe from 'photoswipe';
  
  const initPhotoSwipe = () => {
    const items = document.querySelectorAll('.gallery-item');
    
    items.forEach(item => {
      item.addEventListener('click', (e) => {
        e.preventDefault();
        
        const gallery = new PhotoSwipe({
          dataSource: Array.from(items).map(item => ({
            src: item.getAttribute('href'),
            w: parseInt(item.getAttribute('data-pswp-width')),
            h: parseInt(item.getAttribute('data-pswp-height'))
          })),
          pswpModule: PhotoSwipe
        });
        
        gallery.init();
      });
    });
  };

  // Initialize PhotoSwipe
  initPhotoSwipe();
  
  // Re-initialize when page content updates (for Astro view transitions)
  document.addEventListener('astro:page-load', initPhotoSwipe);
</script>